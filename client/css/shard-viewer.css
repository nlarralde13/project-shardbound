:root{
  /* Blue retro theme */
  --bg:#0d1220; --panel:#111829; --line:#1c2640; --text:#e7eefc; --muted:#9ab0d8;
  --accent:#65d2ff; --chip:#0e1530; --radius:12px;
  --zoom-size:30px; --map-height:680px; --left-col: 500px; --right-col: 420px;
}
*{box-sizing:border-box} html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 800px at 10% -20%, #0f1b32 0%, transparent 60%) no-repeat,
    radial-gradient(900px 600px at 110% 0%, #0f1b32 0%, transparent 60%) no-repeat,
    var(--bg);
  color:var(--text);
  font:14px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
}
header{
  display:flex; align-items:center; gap:12px; padding:12px 16px;
  background:#0c1428cc; backdrop-filter: blur(6px);
  border-bottom:1px solid var(--line); position:sticky; top:0; z-index:10;
}
header h1{ margin:0; font-size:16px; font-weight:700; color:#aee6ff; letter-spacing:.02em }

/* Split grid: left | gutter | right */
.wrap{ display:grid; grid-template-columns: var(--left-col) 8px 1fr var(--right-col); gap:16px; padding:16px; }

/* Cards */
.card{ background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); overflow:hidden; }
.card h2{
  margin:0; padding:10px 12px; background:#0e1630; border-bottom:1px solid var(--line);
  color:#b9ccf0; font-size:13px; letter-spacing:.06em; text-transform:uppercase;
}
.card section{ padding:12px; display:grid; gap:10px; }

/* Left panel */
.pane-left{ min-width:360px; }
.pane-left section{ overflow:visible; }
.pane-left .group{ border:1px solid var(--line); border-radius:10px; padding:10px; background:#0d1530 }
.group h3{ margin:0 0 8px 0; color:#a7b9e6; font-size:12px; letter-spacing:.05em; text-transform:uppercase }

/* Gutter (draggable) */
.gutter{
  background: linear-gradient(180deg, #1e2a47 0%, #16213a 100%);
  border:1px solid #243258; border-radius:8px; cursor: col-resize; align-self: stretch; width:8px;
}
.gutter:focus{ outline:2px solid #65d2ff88; outline-offset:2px; }

/* Right panel (map viewer) */
.viewer{ display:grid; grid-template-rows:auto 1fr auto; gap:10px; min-height:520px }
.canvas-wrap{ position:relative; width:100%; height:var(--map-height); }
.canvas-wrap canvas{
  position:absolute; inset:0; width:100%; height:100%; display:block;
  image-rendering:pixelated; background:#0a0f1f; border:1px solid var(--line); border-radius:10px
}

/* CRT overlay (toggle with .crt on .canvas-wrap) */
.canvas-wrap.crt::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    repeating-linear-gradient(to bottom, rgba(255,255,255,.04), rgba(255,255,255,.04) 1px, transparent 2px);
  mix-blend-mode: overlay; border-radius:10px;
}

.zoomOverlay{ position:absolute; top:10px; right:10px; display:flex; flex-direction:column; gap:8px; z-index:2 }
.zbtn{
  width:var(--zoom-size); height:var(--zoom-size); display:grid; place-items:center; font-weight:900;
  font-size:calc(var(--zoom-size)*.6); background:#0b1430; color:#d6eeff; border:1px solid #26457a; border-radius:8px;
  box-shadow:0 2px 0 rgba(0,0,0,.35);
}
.tooltip{
  position:absolute; left:0; top:0; transform:translate(12px,12px);
  pointer-events:none; display:none; background:#0b1430; color:#e7f7ff; border:1px solid #27477f; border-radius:8px; padding:6px 8px; font-size:12px;
}

/* Inputs */
label{ color:var(--muted) }
select, input, button{
  background:#0b1228; color:var(--text); border:1px solid #2a3a62; border-radius:8px; height:34px; padding:8px 10px;
}
input[type="range"]{ height:32px; padding:0 }
button{ cursor:pointer; background:var(--accent); color:#02283a; border-color:#2aa9db; font-weight:700; }
.secondary{ background:#0b1228; color:var(--text); border-color:#2a3a62 }
.btn-warning{ background:#fbbf24; color:#1f2937; border-color:#b45309 }
.btn-success{ background:#22c55e; color:#052e1a; border-color:#15803d }
.is-dim{ filter: saturate(0.3) brightness(0.9); opacity: 0.7 }
.muted{ color:var(--muted) }
.row{ display:grid; grid-template-columns:130px 1fr; gap:8px; align-items:center }
.row.auto{ grid-template-columns:1fr }
.row.inline-2{ grid-template-columns:1fr 1fr }
.row.inline-3{ grid-template-columns:1fr 1fr 1fr }

/* Legend */
.legend{ display:flex; flex-wrap:wrap; gap:10px; font-size:12px; color:var(--muted) }
.swatch{ display:inline-flex; gap:6px; align-items:center; padding:2px 6px; background:#0e1530; border:1px solid var(--line); border-radius:999px }
.dot{ width:12px; height:12px; border-radius:2px; border:1px solid #081024 }

/* Biome checkbox grid */
.biomes{ display:grid; grid-template-columns:repeat(2,1fr); gap:6px }
.biomes label{ display:flex; gap:6px; align-items:center }

/* Mobile */
@media (max-width:1024px){
  .wrap{ grid-template-columns: 1fr; }
  .gutter{ display:none; }
  .pane-right{ order:3; }
/* Far-right tile info panel */
.pane-right{ min-width:320px; }
.pane-right textarea{ resize: vertical; }
}
